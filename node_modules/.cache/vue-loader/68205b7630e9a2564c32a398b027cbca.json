{"remainingRequest":"C:\\Users\\User\\Desktop\\project\\vee\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Desktop\\project\\vee\\src\\components\\Favor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Desktop\\project\\vee\\src\\components\\Favor.vue","mtime":1586346054136},{"path":"C:\\Users\\User\\Desktop\\project\\vee\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1586346047403},{"path":"C:\\Users\\User\\Desktop\\project\\vee\\node_modules\\babel-loader\\lib\\index.js","mtime":1586346047190},{"path":"C:\\Users\\User\\Desktop\\project\\vee\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1586346047403},{"path":"C:\\Users\\User\\Desktop\\project\\vee\\node_modules\\vue-loader\\lib\\index.js","mtime":1586346053661}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIC8v5b6eaW5kZXgudnVl5LulcHJvcHPlj5blvpdsb2dpbueahHVzZXLos4fmlpkNCiAgcHJvcHM6IFsibG9naW51c2VyIl0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHVzZXJEYXRhOiB0aGlzLmxvZ2ludXNlciwgLy/lsIdwcm9wc+WPluW+l+S9v+eUqOiAheizh+aWmeWtmOWFpXVzZXJEYXRh55So5L6G5Y+W5b6XZmF2b3Los4fmlpnvvIznianku7bmoLzlvI/vvJp7dXNlcm5hbWU6Jycsbmlja25hbWU6Jyd9DQogICAgICB1c2VyRmF2b3I6IFtdLCAvL+WtmOWPluipsuS9v+eUqOiAhWZhdm9y6LOH5paZ77yM6Zmj5YiX5qC85byP44CBaXRlbeeCuueJqeS7tu+8mlt7bmFtZTon57ay56uZ5ZCN56ixJyxjb250ZW50OifntrLlnYAnfSx7fSwuLi5dDQogICAgICB0ZW1wRmF2b3JJdGVtOiB7DQogICAgICAgIG5hbWU6ICIiLA0KICAgICAgICBjb250ZW50OiAiIg0KICAgICAgfSAvL+aaq+WtmOe3qOi8r+S4reeahOizh+aWme+8jOeJqeS7tuagvOW8j++8mntuYW1lOifntrLnq5nlkI3nqLEnLGNvbnRlbnQ6J+e2suWdgCd9DQogICAgfTsNCiAgfSwNCiAgYmVmb3JlQ3JlYXRlKCkgew0KICAgIGRvY3VtZW50LnRpdGxlID0gdGhpcy4kcm91dGUubWV0YS50aXRsZTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBjb25zb2xlLmxvZygidXNlcmRhdGEiLCB0aGlzLnVzZXJEYXRhKTsNCiAgICBjb25zdCB2bSA9IHRoaXM7DQogICAgbGV0IHRlbXBGYXZvckRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJmYXZvcnMiKSk7IC8v5qC85byP54K66Zmj5YiX77yM5YiG5LiN5ZCM5L2/55So6ICF5LiN5ZCM54mp5Lu277yM5LuldXNlcm5hbWXljYDliIZbe3VzZXJuYW1lOicnLGZhdm9yRGF0YTpbe30se31dfSx7fV0NCiAgICAvL2xvY2FsU3RvcmFnZeacieizh+aWme+8jOmAj+mBjmZvckVhY2jku6V1c2VybmFtZeavlOWwjeWPluW+l+atpOS9v+eUqOiAheizh+aWmQ0KICAgIGlmICh0ZW1wRmF2b3JEYXRhKSB7DQogICAgICB0ZW1wRmF2b3JEYXRhLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgIGlmIChpdGVtLnVzZXJuYW1lID09IHZtLnVzZXJEYXRhLnVzZXJuYW1lKSB7DQogICAgICAgICAgdm0udXNlckZhdm9yID0gaXRlbS5mYXZvckRhdGE7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0gZWxzZSB7DQogICAgICAvL+aykuacieizh+aWmeS4jeS9nOWLlQ0KICAgICAgY29uc29sZS5sb2coIk5vLURhdGEiKTsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvL+aWsOWinml0ZW0NCiAgICBhZGRGYXZvckl0ZW0oKSB7DQogICAgICBjb25zdCB2bSA9IHRoaXM7DQogICAgICB2bS4kdmFsaWRhdG9yLnZhbGlkYXRlQWxsKCkudGhlbihyZXN1bHQgPT4gew0KICAgICAgICAvL+ihqOWWruizh+aWmempl+itiemAmumBjg0KICAgICAgICBpZiAocmVzdWx0KSB7DQogICAgICAgICAgdm0udXNlckZhdm9yLnB1c2godm0udGVtcEZhdm9ySXRlbSk7IC8v5bCH57eo6Lyv5Lit6LOH5paZ5a2Y5YWldXNlckZhdm9y6Zmj5YiXDQogICAgICAgICAgbGV0IG5hbWUgPSB2bS51c2VyRGF0YS51c2VybmFtZTsNCiAgICAgICAgICBsZXQgZmF2b3IgPSB2bS51c2VyRmF2b3I7DQogICAgICAgICAgbGV0IGRhdGEgPSBbeyB1c2VybmFtZTogbmFtZSwgZmF2b3JEYXRhOiBmYXZvciB9XTsgLy/mlbTnkIblgrPlhaXos4fmlpnmoLzlvI8NCiAgICAgICAgICBsZXQgdGVtcEZhdm9yRGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImZhdm9ycyIpKTsgLy/mmqvlrZhsb2NhbOeahGZhdm9yc+izh+aWmQ0KICAgICAgICAgIGlmICghdGVtcEZhdm9yRGF0YSkgew0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImZhdm9ycyIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsgLy9sb2NhbOeEoeizh+aWme+8jOebtOaOpeWCs+WFpQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0ZW1wRmF2b3JEYXRhLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgIGlmIChpdGVtLnVzZXJuYW1lID09IHZtLnVzZXJEYXRhLnVzZXJuYW1lKSB7DQogICAgICAgICAgICAgICAgLy9sb2NhbOacieizh+aWme+8jOaJvuWIsHVzZXJuYW1l5ZCM562G6LOH5paZ77yM5pW05YyF5pu/5o+bDQogICAgICAgICAgICAgICAgaXRlbS5mYXZvckRhdGEgPSBmYXZvcjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiZmF2b3JzIiwgSlNPTi5zdHJpbmdpZnkodGVtcEZhdm9yRGF0YSkpOyAvL+Wwh+abv+aPm+WujOizh+aWmeaVtOethuWCs+WFpQ0KICAgICAgICAgIH0NCiAgICAgICAgICAvLyAgIHZtLnRlbXBGYXZvckl0ZW0gPSB7IG5hbWU6ICIiLCBjb250ZW50OiAiIiB9Ow0KICAgICAgICAgIC8vICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3VybCIpLmNsYXNzTGlzdC5yZW1vdmUoImlzLWludmFsaWQiKTsNCiAgICAgICAgICAvLyAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNuYW1lIikuY2xhc3NMaXN0LnJlbW92ZSgiaXMtaW52YWxpZCIpOw0KICAgICAgICAgIHRoaXMuJGRhdGEudGVtcEZhdm9ySXRlbSA9IHRoaXMuJG9wdGlvbnMuZGF0YSgpLnRlbXBGYXZvckl0ZW07IC8v5riF6ZmkdGVtcEZhdm9ySXRlbeizh+aWmeWbnuWIsOmgkOioreWAvA0KICAgICAgICAgIHRoaXMuZXJyb3JzLmNsZWFyKCk7IC8v5riF56m65omA5pyJZXJyb3NCYWfpjK/oqqToqIrmga8NCiAgICAgICAgICB0aGlzLiR2YWxpZGF0b3IucmVzZXQoKTsgLy/muIXnqbrmraR2YWxpZGF0b3Lni4DmhYsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBkZWxJdGVtKGluZGV4KSB7DQogICAgICBjb25zdCB2bSA9IHRoaXM7DQogICAgICB2bS51c2VyRmF2b3Iuc3BsaWNlKGluZGV4LCAxKTsgLy/lvp7op7jnmbxpdGVt5Y+W5b6XaW5kZXjvvIzlvp7os4fmlpnkuK3liKrpmaQNCiAgICAgIGxldCBmYXZvciA9IHZtLnVzZXJGYXZvcjsNCiAgICAgIGxldCB0ZW1wRmF2b3JEYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiZmF2b3JzIikpOyAvL+aaq+WtmGxvY2Fs55qEZmF2b3Los4fmlpkNCiAgICAgIHRlbXBGYXZvckRhdGEuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaWYgKGl0ZW0udXNlcm5hbWUgPT0gdm0udXNlckRhdGEudXNlcm5hbWUpIHsNCiAgICAgICAgICBpdGVtLmZhdm9yRGF0YSA9IGZhdm9yOyAvL+aJvuWIsOebuOWQjHVzZXJuYW1l5pu/5o+b5pW05YCLZmF2b3JEYXRh6Zmj5YiX6LOH5paZDQogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImZhdm9ycyIsIEpTT04uc3RyaW5naWZ5KHRlbXBGYXZvckRhdGEpKTsgLy/lsIfmm7/mj5vlrozos4fmlpnmlbTnrYblgrPlhaUNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBsb2dvdXQoKXsNCiAgICAgIGNvbnN0IHZtID0gdGhpcw0KICAgICAgdm0uJGVtaXQoJ3VzZXJsb2dvdXQnKQ0KICAgICAgdm0uJHJvdXRlci5wdXNoKCcvJykNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["Favor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Favor.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"container my-5\">\r\n      <div class=\"row py-3 justify-content-center\">\r\n        <div class=\"col-9 d-flex justify-content-end\">\r\n          <button class=\"btn btn-outline-danger\" @click=\"logout\">登出</button>\r\n        </div>\r\n      </div>\r\n      <div class=\"row justify-content-center\">\r\n        <div class=\"col-9 p-3 rounded border\">\r\n          <h1 class=\"font-weight-bold\">我的最愛清單</h1>\r\n          <div class=\"text-center text-primary h4\">Hi 親愛的 <span class=\"text-warning h5\">{{userData.nickname}}</span>您好！</div>\r\n          <div class=\"text-center text-secondary\">請填入名稱與網址，將網站加入我的最愛清單</div>\r\n          <form action class=\"py-3\">\r\n            <div class=\"container\">\r\n              <div class=\"form-row\">\r\n                <div class=\"form-group col-3 mb-0\">\r\n                  <label for=\"name\" class=\"text-left\">網站名稱</label>\r\n                  <!-- 設定必填、至少2個字元驗證，連結資料tempFavorItem暫存在name -->\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"name\"\r\n                    class=\"form-control\"\r\n                    placeholder=\"請輸入名稱\"\r\n                    v-validate=\"'required|min:2'\"\r\n                    data-vv-as=\"網站名稱\"\r\n                    name=\"name\"\r\n                    v-model=\"tempFavorItem.name\"\r\n                    :class=\"{'is-invalid':errors.has('name'),'is-valid':!errors.has('name')&&tempFavorItem.name!==''}\"\r\n                  />\r\n                </div>\r\n                <div class=\"form-group col-7 mb-0\">\r\n                  <label for=\"url\">網址</label>\r\n                  <!-- 設定必填、網址格式(含http的protocol)，連結資料tempFavorItem暫存在content -->\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"url\"\r\n                    class=\"form-control\"\r\n                    placeholder=\"請輸入網址\"\r\n                    v-validate=\"{required:true,url:{require_protocol:true}}\"\r\n                    data-vv-as=\"網址\"\r\n                    name=\"url\"\r\n                    v-model=\"tempFavorItem.content\"\r\n                    :class=\"{'is-invalid':errors.has('url'),'is-valid':!errors.has('url')&&tempFavorItem.content!==''}\"\r\n                  />\r\n                </div>\r\n                <div class=\"form-group col-2 align-self-end mb-0\">\r\n                  <div class=\"btn btn-primary\" @click=\"addFavorItem\">加入</div>\r\n                </div>\r\n              </div>\r\n              <div class=\"form-row\">\r\n                <div class=\"form-group col-3\">\r\n                  <div v-show=\"errors.has('name')\">\r\n                    <span class=\"small text-danger\">{{errors.first('name')}}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"form-group col-7\">\r\n                  <div v-show=\"errors.has('url')\">\r\n                    <span class=\"small text-danger\">{{errors.first('url')}}應如：https://www.google.com</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n          <div class=\"list container\">\r\n            <ul class=\"list-group\">\r\n              <li class=\"list-group-item d-flex\" v-for=\"(item,index) in userFavor\" :key=\"index\">\r\n                <div>{{item.name}}</div>\r\n                <div class=\"ml-3\">\r\n                  <a :href=\"item.content\" target=\"_blank\">{{item.content}}</a>\r\n                </div>\r\n                <!-- 點擊刪除該item(以index判斷) -->\r\n                <button type=\"button\" class=\"close ml-auto\" @click=\"delItem(index)\">\r\n                  <span aria-hidden=\"true\">&times;</span>\r\n                </button>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  //從index.vue以props取得login的user資料\r\n  props: [\"loginuser\"],\r\n  data() {\r\n    return {\r\n      userData: this.loginuser, //將props取得使用者資料存入userData用來取得favor資料，物件格式：{username:'',nickname:''}\r\n      userFavor: [], //存取該使用者favor資料，陣列格式、item為物件：[{name:'網站名稱',content:'網址'},{},...]\r\n      tempFavorItem: {\r\n        name: \"\",\r\n        content: \"\"\r\n      } //暫存編輯中的資料，物件格式：{name:'網站名稱',content:'網址'}\r\n    };\r\n  },\r\n  beforeCreate() {\r\n    document.title = this.$route.meta.title;\r\n  },\r\n  created() {\r\n    console.log(\"userdata\", this.userData);\r\n    const vm = this;\r\n    let tempFavorData = JSON.parse(localStorage.getItem(\"favors\")); //格式為陣列，分不同使用者不同物件，以username區分[{username:'',favorData:[{},{}]},{}]\r\n    //localStorage有資料，透過forEach以username比對取得此使用者資料\r\n    if (tempFavorData) {\r\n      tempFavorData.forEach(item => {\r\n        if (item.username == vm.userData.username) {\r\n          vm.userFavor = item.favorData;\r\n        }\r\n      });\r\n    } else {\r\n      //沒有資料不作動\r\n      console.log(\"No-Data\");\r\n    }\r\n  },\r\n  methods: {\r\n    //新增item\r\n    addFavorItem() {\r\n      const vm = this;\r\n      vm.$validator.validateAll().then(result => {\r\n        //表單資料驗證通過\r\n        if (result) {\r\n          vm.userFavor.push(vm.tempFavorItem); //將編輯中資料存入userFavor陣列\r\n          let name = vm.userData.username;\r\n          let favor = vm.userFavor;\r\n          let data = [{ username: name, favorData: favor }]; //整理傳入資料格式\r\n          let tempFavorData = JSON.parse(localStorage.getItem(\"favors\")); //暫存local的favors資料\r\n          if (!tempFavorData) {\r\n            localStorage.setItem(\"favors\", JSON.stringify(data)); //local無資料，直接傳入\r\n          } else {\r\n            tempFavorData.forEach(item => {\r\n              if (item.username == vm.userData.username) {\r\n                //local有資料，找到username同筆資料，整包替換\r\n                item.favorData = favor;\r\n              }\r\n            });\r\n            localStorage.setItem(\"favors\", JSON.stringify(tempFavorData)); //將替換完資料整筆傳入\r\n          }\r\n          //   vm.tempFavorItem = { name: \"\", content: \"\" };\r\n          //   document.querySelector(\"#url\").classList.remove(\"is-invalid\");\r\n          //   document.querySelector(\"#name\").classList.remove(\"is-invalid\");\r\n          this.$data.tempFavorItem = this.$options.data().tempFavorItem; //清除tempFavorItem資料回到預設值\r\n          this.errors.clear(); //清空所有errosBag錯誤訊息\r\n          this.$validator.reset(); //清空此validator狀態\r\n        }\r\n      });\r\n    },\r\n    delItem(index) {\r\n      const vm = this;\r\n      vm.userFavor.splice(index, 1); //從觸發item取得index，從資料中刪除\r\n      let favor = vm.userFavor;\r\n      let tempFavorData = JSON.parse(localStorage.getItem(\"favors\")); //暫存local的favor資料\r\n      tempFavorData.forEach(item => {\r\n        if (item.username == vm.userData.username) {\r\n          item.favorData = favor; //找到相同username替換整個favorData陣列資料\r\n          localStorage.setItem(\"favors\", JSON.stringify(tempFavorData)); //將替換完資料整筆傳入\r\n        }\r\n      });\r\n    },\r\n    logout(){\r\n      const vm = this\r\n      vm.$emit('userlogout')\r\n      vm.$router.push('/')\r\n    }\r\n  }\r\n};\r\n</script>"]}]}